---
layout:     post                          # 使用的布局（不需要改）
title:      大一学年总结                   # 标题 
subtitle:   被各路神仙吊打并将持续吊打的过程 # 副标题
date:       2019-08-12                    # 时间
author:     小雨时宁                       # 作者
header-img: img/HelloWorld3.jpg           # 这篇文章标题背景图片
catalog: true                             # 是否归档
tags:                                     # 标签
    - C语言
    - 入门教学
---

## 前言

&emsp;&emsp;本教程供予Nova独游社大一新生入社教学用，故使用C语言实现了贪吃蛇的基本功能，可由玩家自己添加更多细节（得分，欢迎界面，颜色布局等）

## 完整代码

```c

#include<stdio.h>  

#include<Windows.h>
 
 void InitializeGame();  
 void PrintGame(int map[20][20]);  
 void MoveToPos(int x, int y);  
 void RunTheGame();  
 void CreateFood(int map[20][20]);  
 int ChangeSnake();  
 int SnakeMove(int map[20][20]);  
 
 int map[20][20] = {0};
 int snakeNextMove = 1;
 int snakeLength = 4;
 int foodIsAte = 1;

 int main(void)
 {
 	InitializeGame();
 	RunTheGame();
 	return 0;
 }
 
 void RunTheGame()
 {
 	while(1)
 	{
 		int endOrContinue;
 		snakeNextMove = ChangeSnake();
 		system("cls");
 		endOrContinue = SnakeMove(map);
 		if(foodIsAte == 1)
 		{
 			CreateFood(map);
		}
		PrintGame(map);
		if(endOrContinue == -1)
		{
			break;
		}
		Sleep(500);	
	}
 }
 
 void CreateFood(int map[20][20])
 {
 	int food_x;
 	int food_y;
 	srand((int)time(NULL));
 	while(1)
 	{
 		food_x = rand()%20;
 		food_y = rand()%20;
 		if(map[food_x][food_y] == 0)
 		{
 			break;
		}
	}
	map[food_x][food_y] = 1000;
	foodIsAte = 0;
 }
 
 
 int ChangeSnake()
 {
 	char click;
 	if (_kbhit())
	{
		click = _getch();
	}
	if(click == 'w')
	{
		return 1;
	}
	else if(click == 's')
	{
		return 2;
	}
	else if(click == 'a')
	{
		return 3;
	}
	else if(click == 'd')
	{
		return 4;
	}
	else 
	{
		return snakeNextMove;
	}
 } 
 
 int SnakeMove(int map[20][20])
 {
 	int i, j;
 	int nowSnakeHead_x, nowSnakeHead_y, nowSnakeTail_x, nowSnakeTail_y;
	for(i = 0;i < 20;i++)
	{
		for(j = 0;j < 20;j++)
		{
			if(map[i][j] == 2)
			{
				nowSnakeHead_x = i;
				nowSnakeHead_y = j;	
			}
			if(map[i][j] == snakeLength + 1)
			{
				nowSnakeTail_x = i;
				nowSnakeTail_y = j;
			}	
		} 
	}
	
	if(snakeNextMove == 1)
	{
		nowSnakeHead_y -= 1;
	}
	else if(snakeNextMove == 2)
	{
		nowSnakeHead_y += 1;
	}
	else if(snakeNextMove == 3)
	{
		nowSnakeHead_x -= 1;
	}
	else
	{
		nowSnakeHead_x += 1;
	}
	
	if(map[nowSnakeHead_x][nowSnakeHead_y] > 0&&map[nowSnakeHead_x][nowSnakeHead_y] <= 361)
	{
		return -1;	
	}
	else
	{
		if(map[nowSnakeHead_x][nowSnakeHead_y] == 0)
		{
			map[nowSnakeHead_x][nowSnakeHead_y] = 1;
			map[nowSnakeTail_x][nowSnakeTail_y] = 0;
			for(i = 0;i < 20;i++)
			{
				for(j = 0;j < 20;j++)
				{
					if(map[i][j] != 0&&map[i][j] > 1&&map[i][j] != 1000)
					{
						map[i][j]++;
					}
				}
			}
			map[nowSnakeHead_x][nowSnakeHead_y] += 1;
		} 
		else
		{
			map[nowSnakeHead_x][nowSnakeHead_y] = 1;
			snakeLength++; 
			foodIsAte = 1;
			for(i = 0;i < 20;i++)
			{
				for(j = 0;j < 20;j++)
				{
					if(map[i][j] != 0&&map[i][j] > 1&&map[i][j] != 1000)
					{
						map[i][j]++;
					}
				}
			}
			map[nowSnakeHead_x][nowSnakeHead_y] += 1;
		} 
		return 1;
	}		
 } 
 
 void PrintGame(int map[20][20])
 {
 	int i, j;
 	for(i = 0;i < 20;i++)
 	{
 		for(j = 0;j < 20;j++)
		{
			if(map[i][j] >= 1&&map[i][j] <= 361)
			{
				MoveToPos(i * 2, j);
				printf("■"); 
			}
			else if(map[i][j] == 1000)
			{
				MoveToPos(i * 2, j);
				printf("□");	
			} 
		}
	}
 }
 
 void InitializeGame()
 {
 	int i, j;
 	for(i = 0;i < 20;i++)
 	{
 		if(i == 0||i == 19)
 		{
 			for(j = 0;j < 20;j++)
			{
				map[i][j] = 1;	 	
			}	
		}
		else
		{
			map[i][0] = 1;
			map[i][19] = 1;
		} 		
	}
	
	map[8][7] = 2; 
	map[8][8] = 3;
	map[8][9] = 4;
	map[8][10] = 5;
 }
 
 void MoveToPos(int x, int y)
 {
	COORD pos;
	HANDLE hOutput;
	pos.X = x;
	pos.Y = y;
	hOutput = GetStdHandle(STD_OUTPUT_HANDLE);
	SetConsoleCursorPosition(hOutput, pos);
 }

```
&emsp;&emsp;下面，让我们逐步来分析我们的代码
## 一、贪吃蛇的移动方法
我们先了解一下贪吃蛇的两种移动方式
1.全身移动法

  ![](/img/snake1.png)
>每个蛇的身体都是一个节点，蛇头往前移动，第二级身体移动到蛇头上一秒的位置，第三级身体移动到第二级身体上一秒的位置，以此类推，蛇就整体往前移动了一格

2.移尾移动法
 ![](/img/snake2.png)
>我们把蛇尾的块移动到蛇头下一秒将移动的位置，然后这个块就变成蛇头，我们只移动一个块就实现了蛇的移动，如果当蛇的长度到非常大（比如说我蛇长已经20+或者多少个节点的时候），如果用第一种方法，每次移动都需要移动20多次，而如果用第二种，每次移动依然还是只移动一次，就实现了蛇的移动

当然，这个时候抛一些问题让大家思考一下：
>（1）如果我将蛇身涂成一个红一个白一个红一个白……这种，采用哪一种移动方式更合适？为什么？  
（2）如果某种方式不适合，有没有什么简单的改动就能使这种移动方式也能适合间隔色涂装的蛇移动

我们这个入门级教程里，用二维数组来表示地图，蛇，食物这些，并通过最简单的输出语句来输出，通过屏幕清除的函数来每次刷新界面（会有一点问题，但是为了要简单。。而且适应大家的水平。。所以先用这个把）

使用的新东西（不需详细知道）：移动光标函数，清屏函数

下面开始正式教学
## 二、打印地图边框
###1、我们需要使用到一个光标跳转的函数
```c
 void MoveToPos(int x, int y)
 {
	COORD pos;
	HANDLE hOutput;
	pos.X = x;
	pos.Y = y;
	hOutput = GetStdHandle(STD_OUTPUT_HANDLE);
	SetConsoleCursorPosition(hOutput, pos);
 }
 ```
 隶属于头文件
 ```c
  #include<window.h>
 ```
 函数可以实现光标跳转到指定位置的功能
 
 ###2、建一个二维数组，并使用0初始化
 ```c
   int map[20][20] = {0};
 ```
 C语言会将map[0][0]这个元素替换为0，然后因为之后的元素程序都没给出，所以系统会默认用0来补全这个数组

###3、1表示地图的边界，我们通过一个函数来把数组边缘一圈赋值为1
 ```c
   void InitializeGame()
 {
 	int i, j;
 	for(i = 0;i < 20;i++)
 	{
 		if(i == 0||i == 19)
 		{
 			for(j = 0;j < 20;j++)
			{
				map[i][j] = 1;	 	
			}	
		}
		else
		{
			map[i][0] = 1;
			map[i][19] = 1;
		} 		
	}
 }
 ```
 
###4、建立一个打印的函数，根据数组的元素来把界面打印出来
 ```c
 void PrintGame(int map[20][20])
 {
 	int i, j;
 	for(i = 0;i < 20;i++)
 	{
 		for(j = 0;j < 20;j++)
		{
			if(map[i][j] == 1)
			{
				MoveToPos(i * 2, j);
				printf("■"); 
			}
		}
	}
 }
 ```
 这个函数在遇到1的时候会打印一个黑色方块

###5、一阶段收束，我们看一下现在的运行结果
 ![](/img/snake3.png)
>地图成功打印
